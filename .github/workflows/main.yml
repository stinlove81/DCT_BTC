on:

  schedule:

    # 한국 시간(KST) 매일 18:00는 UTC 시간으로 09:00입니다.

    - cron: '0 9 * * *'

  workflow_dispatch: # 사장님이 원할 때 수동으로 바로 실행하는 버튼



jobs:

  build:

    runs-on: ubuntu-latest

    steps:

      - name: Checkout code

        uses: actions/checkout@v3



      - name: Set up Python

        uses: actions/setup-python@v4

        with:

          python-version: '3.10'



      - name: Install dependencies

        run: |

          pip install pandas requests beautifulsoup4 yfinance



      - name: Run Python script

        env:

          # 깃허브 Secrets에 저장한 비번을 파이썬으로 전달

          MY_GMAIL_USER: ${{ secrets.MY_GMAIL_USER }}

          MY_GMAIL_PW: ${{ secrets.MY_GMAIL_PW }}

        run: python update_data.py



      - name: Commit and Push changes

        run: |

          git config --global user.name "GitHub Action"

          git config --global user.email "action@github.com"

          git add data.json

          git commit -m "Auto-update data.json" || exit 0

          git push
